<!-- Page Content -->
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
<div class="room-page-div-wrapper" id="page-wrapper">


<!-- VIDEO SIDEBARS -->
<!-- This section is the sidebar for the local and peer video connections -->
<!-- to be dragged and dropped -->
   <div id = 'video-sidebar'>
      <div class="small-vids" id = "video-spot-1">
         <video class="video-center" id="localVideo" autoplay></video>
      </div>
      <div class="small-vids" id = "video-spot-2"> </div>
      <div class="small-vids" id = "video-spot-3"> </div>
      <div class="small-vids" id = "video-spot-4"> </div>
      <div class="small-vids" id = "video-spot-5"> </div>
   </div>
   <div class = "benedict-zone">
      <%= render 'rooms/room_content_table' %>
   </div>

  <div class="below-sidebar">

  </div>


<!-- END OF VIDEO SIDEBARS -->



<!-- ROOM RIGHT HAND SIDEBAR -->


<%= render 'rooms/room_right_hand_sidebar' %>


<!-- END OF ROOM RIGHT HAND SIDEBAR -->





<script type="text/javascript" src="https://apis.google.com/js/api.js"></script>
<script src="https://www.google.com/jsapi" type="text/javascript"></script>

<script language="Javascript" type="text/javascript">

google.load('search', '1');
</script>

<script>


// Progress loading bar function for user feedback that
// the queries are being analyzed

$(function() {
  var progressbar = $( "#progressbar" ),
    progressLabel = $( ".progress-label" );

  progressbar.progressbar({
    value: false
  });
});


// This is a function that flashes the red microphone
// glyph so that users are given feedback to when audio
// is being recorded

function blink_red() {
  $('.record-button').fadeTo(800, .1, function(){});
  $('.record-button').fadeTo(800, 1, function() {});
}


// the variable for the interval so that it can be set
// and removed in this scope

var red_record_interval;

var keydown_triggered_by_button = 0;

// this is a function that is triggered upon users
// clicking the record button

$('#record-query-button').click(function() {
  var e1 = jQuery.Event("keydown");
  e1.which = 2;
  //keydown_triggered_by_button = 1;
  $("input").trigger(e1);
});

// this is a function that is triggered upon users
// clicking the stop button when they are finished
// recording


$('#stop-query-button').click(function() {
  toggle_mic_color = 0;
  var e2 = jQuery.Event("keyup");
  e2.which = 17;
  console.log("hello!")
  $("input").trigger(e2);
});


// this function that listens for users clicking on the
// black x glyph in center renders so that we can
// remove them

$(document).on('click','#remove_item_id',function(){
  $('.render_spot').remove();
  $('.center-border').fadeOut(300);
  inter = setInterval(blinker, 3000);
});


// respective drag andn droppable functions for
// the video sidebar


var video_spots = [0,0,0,0,0,0];
$(function() {
   $( "#localVideo" ).draggable({
  revert: function(socketObj) {
    if (socketObj === false) {
        // Drop was rejected, revert the helper.
        var $helper = $("#localVideo");
        $helper.animate($helper.originalPosition);
        $helper.animate({ width: "100%", height: "100%" });
        return true;
    } else {
        // Drop was accepted, don't revert.
        return false;
    }},
  opacity: .7,
   create: function(event, ui) {
       $(this).draggable("option", "cursorAt", {
           left: Math.floor(80),
           top: Math.floor(60)
       });
   },
   start: function(event, ui){
       if($(this).width() > 160){
       $(this).css("width", "160px" );
       $(this).css("height", "120px");
       }
   }
   });
   take_spot(0, $( "#localVideo" ));
   $( "#video-spot-1" ).droppable({
       activeClass: "active-video-spot",
       drop: function( event, ui ) {
       take_spot(0, $("#" + ui.draggable.prop('id')), $("#video-spot-1"));
       $("#video-spot-1").append( $("#" + ui.draggable.prop('id')) ) ;
       $("#" + ui.draggable.prop('id')).css("top", "0%");
       $("#" + ui.draggable.prop('id')).css("left", "0%");
       $("#" + ui.draggable.prop('id')).css("width", "100%");
       $("#" + ui.draggable.prop('id')).get(0).play();
       }
   });
   $( "#video-spot-2" ).droppable({
       activeClass: "active-video-spot",
       drop: function( event, ui ) {
       take_spot(1, $("#" + ui.draggable.prop('id')));
       $("#video-spot-2").append( $("#" + ui.draggable.prop('id')) );
       $("#" + ui.draggable.prop('id')).css("top", "0%");
       $("#" + ui.draggable.prop('id')).css("left", "0%");
       $("#" + ui.draggable.prop('id')).css("width", "100%");
       $("#" + ui.draggable.prop('id')).get(0).play();
       }
   });
   $( "#video-spot-3" ).droppable({
       activeClass: "active-video-spot",
       drop: function( event, ui ) {
       take_spot(2, $("#" + ui.draggable.prop('id')));
       $("#video-spot-3").append( $("#" + ui.draggable.prop('id')));
       $("#" + ui.draggable.prop('id')).css("top", "0%");
       $("#" + ui.draggable.prop('id')).css("left", "0%");
       $("#" + ui.draggable.prop('id')).css("width", "100%");
       $("#" + ui.draggable.prop('id')).get(0).play();
       }
   });
   $( "#video-spot-4" ).droppable({
       activeClass: "active-video-spot",
       drop: function( event, ui ) {
       take_spot(3, $("#" + ui.draggable.prop('id')));
       $("#video-spot-4").append( $("#" + ui.draggable.prop('id')));
       $("#" + ui.draggable.prop('id')).css("top", "0%");
       $("#" + ui.draggable.prop('id')).css("left", "0%");
       $("#" + ui.draggable.prop('id')).css("width", "100%");
       $("#" + ui.draggable.prop('id')).get(0).play();
       }
   });
   $( "#video-spot-5" ).droppable({
       activeClass: "active-video-spot",
       drop: function( event, ui ) {
       take_spot(4, $("#" + ui.draggable.prop('id')));
       $("#video-spot-5").append( $("#" + ui.draggable.prop('id')));
       $("#" + ui.draggable.prop('id')).css("top", "0%");
       $("#" + ui.draggable.prop('id')).css("left", "0%");
       $("#" + ui.draggable.prop('id')).css("width", "100%");
       $("#" + ui.draggable.prop('id')).get(0).play();
       }
   });
});
</script>